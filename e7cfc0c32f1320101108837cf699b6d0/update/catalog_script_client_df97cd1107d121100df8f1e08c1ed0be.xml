<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="catalog_script_client">
    <catalog_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_catalog>true</applies_catalog>
        <applies_extended>false</applies_extended>
        <applies_req_item>false</applies_req_item>
        <applies_sc_task>false</applies_sc_task>
        <applies_target_record>false</applies_target_record>
        <applies_to>item</applies_to>
        <cat_item display_value="Mobile Devices &amp; Services">e5cbbc55079121100df8f1e08c1ed0d3</cat_item>
        <cat_variable>IO:f1220159079121100df8f1e08c1ed045</cat_variable>
        <condition/>
        <description/>
        <field/>
        <global>true</global>
        <isolate_script>true</isolate_script>
        <messages/>
        <name>On Change Main type</name>
        <order/>
        <published_ref/>
        <script><![CDATA[function onChange(control, oldValue, newValue, isLoading) {
    if (isLoading) {
        if (g_form.getValue('selection_type') == 'Service') {
            g_form.setMandatory('phone_numbernew', false);
            g_form.setDisplay('phone_numbernew', false);
            g_form.setDisplay('services', true);
            g_form.setMandatory('services', true);
        } else if (g_form.getValue('selection_type') == 'Accessories') {
            g_form.setMandatory('phone_numbernew', false);
            g_form.setDisplay('phone_numbernew', false);
            g_form.setDisplay('device_accessory', true);
            g_form.setMandatory('device_accessory', true);
        } else if (g_form.getValue('selection_type') == 'New Line' || g_form.getValue('selection_type') == 'Device Only') {
            g_form.setMandatory('phone_numbernew', false);
            g_form.setDisplay('phone_numbernew', false);

            g_form.setMandatory('device_accessory', false);
            g_form.setDisplay('device_accessory', false);
            g_form.setMandatory('services', false);
            g_form.setDisplay('services', false);

            g_form.setDisplay('new_device_type', true);
            g_form.setMandatory('new_device_type', true);

            g_form.setValue('order_for', g_form.getValue('selection_type'));

            deviceselection(g_form.getValue('requested_for'), g_form.getValue('selection_type'));

        }
        return;
    }

    g_form.clearValue('services');
    g_form.clearValue('Accessories');
    g_form.clearValue('device_accessory');
    g_form.clearValue('select_device_model');
    g_form.clearValue('memory');
    g_form.clearValue('color');
    g_form.clearValue('phone_numbernew');
    g_form.clearValue('new_device_type');

    g_form.setMandatory('memory', false);
    g_form.setDisplay('memory', false);

    g_form.setMandatory('color', false);
    g_form.setDisplay('color', false);

    g_form.setMandatory('select_device_model', false);
    g_form.setDisplay('select_device_model', false);



    if (newValue == 'Accessories') {
        g_form.setMandatory('phone_numbernew', false);
        g_form.setDisplay('phone_numbernew', false);

        g_form.setMandatory('services', false);
        g_form.setDisplay('services', false);
        g_form.setMandatory('new_device_type', false);
        g_form.setDisplay('new_device_type', false);
        g_form.setDisplay('device_accessory', true);
        g_form.setMandatory('device_accessory', true);

    } else if (newValue == 'Service') {

        g_form.setMandatory('phone_numbernew', false);
        g_form.setDisplay('phone_numbernew', false);
        g_form.setDisplay('image', false);
        g_form.setMandatory('device_accessory', false);
        g_form.setDisplay('device_accessory', false);
        g_form.setMandatory('new_device_type', false);
        g_form.setDisplay('new_device_type', false);
        g_form.setDisplay('services', true);
        g_form.setMandatory('services', true);
    } else if (newValue == 'New Line' || newValue == 'Device Only') {
        g_form.setMandatory('phone_numbernew', false);
        g_form.setDisplay('phone_numbernew', false);
        g_form.setMandatory('device_accessory', false);
        g_form.setDisplay('device_accessory', false);
        g_form.setMandatory('services', false);
        g_form.setDisplay('services', false);

        g_form.setDisplay('new_device_type', true);
        g_form.setMandatory('new_device_type', true);

        g_form.setValue('order_for', newValue);

        deviceselection(g_form.getValue('requested_for'), newValue);

    } else {
        g_form.setDisplay('phone_numbernew', true);
        g_form.setMandatory('phone_numbernew', true);
        numberselection(g_form.getValue('requested_for'));

        g_form.setDisplay('image', false);
        g_form.setMandatory('device_accessory', false);
        g_form.setDisplay('device_accessory', false);
        g_form.setMandatory('services', false);
        g_form.setDisplay('services', false);
        g_form.setMandatory('new_device_type', false);
        g_form.setDisplay('new_device_type', false);
    }

}

function numberselection(user) {
    var ga = new GlideAjax('x_sakon_mobile.sakon_order_guide');
    ga.addParam('sysparm_name', 'getphonenumbers');
    ga.addParam('order_for', user);
    ga.getXML(phonenumberdetails);
}

function phonenumberdetails(serverResponse) {
    var respose = serverResponse.responseXML.documentElement.getAttribute("answer").split(',');

    g_form.clearOptions('phone_numbernew');
    g_form.addOption('phone_numbernew', '', '-- None --', 0);
    if (respose != '') {
        for (var i = 0; i < respose.length; i++) {
            g_form.addOption('phone_numbernew', respose[i], respose[i], i + 1);
        }
    } else {
        g_form.showFieldMsg('phone_numbernew', 'No Service Lines found for ' + g_form.getDisplayValue('requested_for'), 'error');
        g_form.addErrorMessage('No Service Lines found for ' + g_form.getDisplayValue('requested_for'));
    }

}

function deviceselection(value, type) {
    var ga = new GlideAjax('x_sakon_mobile.sakon_order_guide');
    ga.addParam('sysparm_name', 'getdevicecategoryresult');
    ga.addParam('sysparm_sakon_id', value);
    ga.addParam('sysparm_type_id', type);
    ga.getXML(deviceresponse);
}


function deviceresponse(serverResponse) {
    var respose = serverResponse.responseXML.documentElement.getAttribute("answer").split(',');
    g_form.clearOptions('new_device_type');
    g_form.addOption('new_device_type', '', '-- None --', 0);
    if (respose.length >= 1 && respose != '') {
        for (var i = 0; i < respose.length; i++) {
            g_form.addOption('new_device_type', respose[i], respose[i], i + 1);
        }
    } else {
        g_form.showFieldMsg('new_device_type', 'Not Eligible');
        g_form.addInfoMessage('Not Eligible');
    }

}]]></script>
        <sys_class_name>catalog_script_client</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-02-27 17:49:39</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>df97cd1107d121100df8f1e08c1ed0be</sys_id>
        <sys_mod_count>26</sys_mod_count>
        <sys_name>On Change Main type</sys_name>
        <sys_overrides/>
        <sys_package display_value="Sakon Mobile v2" source="x_sakon_mobile">e7cfc0c32f1320101108837cf699b6d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="Sakon Mobile v2">e7cfc0c32f1320101108837cf699b6d0</sys_scope>
        <sys_update_name>catalog_script_client_df97cd1107d121100df8f1e08c1ed0be</sys_update_name>
        <sys_updated_by>Shaik</sys_updated_by>
        <sys_updated_on>2023-09-20 01:06:33</sys_updated_on>
        <table/>
        <type>onChange</type>
        <ui_type>10</ui_type>
        <variable_set/>
        <view/>
    </catalog_script_client>
</record_update>
